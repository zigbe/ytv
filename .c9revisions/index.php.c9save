{"ts":1363022592314,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1363022601625,"patch":[[{"diffs":[[1,"<?php\n    $localtime = localtime();\n    $hour = ($localtime[2] < 10 ? \"0\" . $localtime[2] : $localtime[2]);\n\t$min = ($localtime[1] < 10 ? \"0\" . $localtime[1] : $localtime[1]);\n\t$horaServer = $hour . \":\" . $min;\n\techo $horaServer;\n?>\n<html>\n\t<head>\n\n\t\t<link rel=\"stylesheet\" type=\"text/css\" media=\"all\" href=\"styles.css\" />\n\t\t<script src=\"https:////ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\"></script>\n\t\t<script type=\"text/javascript\" src=\"jlinq.js\" ></script>\n        <script type=\"text/javascript\" src=\"data.js\" ></script>\n        <script type=\"text/javascript\" src=\"programacao.js\" ></script>\n\n\t\t<script src=\"okvideo.js\"></script>\n\n\t\t<script language=\"javascript\">\n\t\t\n\t\t\t///tools\n\n\t\t\tfunction arrayObjectIndexOf(myArray, searchTerm, property) {\n\t\t\t    for(var i = 0, len = myArray.length; i < len; i++) {\n\t\t\t        if (myArray[i][property] === searchTerm) return i;\n\t\t\t    }\n\t\t\t    return -1;\n\t\t\t}\n\n\t\t\tvar getClosestValues = function(a, x) {\n\t\t\t    var lo = 0, hi = a.length-1;\n\t\t\t    while (hi - lo > 1) {\n\t\t\t        var mid = Math.round((lo + hi)/2);\n\t\t\t        if (a[mid] <= x) {\n\t\t\t            lo = mid;\n\t\t\t        } else {\n\t\t\t            hi = mid;\n\t\t\t        }\n\t\t\t    }\n\t\t\t    if (a[lo] == x) hi = lo;\n\n\t\t\t    if(a[hi]<x){\n\t\t\t    \treturn [a[hi]];\n\t\t\t    }\n\t\t\t    return [a[lo], a[hi]];\n\t\t\t}\n\n\n\t\t\t/// ver que horas sao e que dia Ã© hoje\n\t\t\tvar d = new Date();\n\t\t\tvar horas = d.getHours().toString();\n\t\t\tvar minutos =  d.getMinutes().toString();\n            var segundos = d.getSeconds();\n\t\t\tvar dia = d.getDate();\n\t\t\tvar mes = d.getMonth() + 1;\n\t\t\tvar ano = d.getFullYear();\n            var horaAtual = ((horas < 10) ? \"0\" + horas : horas) + \":\" + ((minutos < 10) ? \"0\" + minutos : minutos);\n\n\t\t\t\n\t\t\t///document.write(\"<div id=horas>\" + horas + \" - \" + minutos + \" - \" + dia + \" - \" + mes + \" - \" + ano + \"</div>\");\n\t\t\t\n\n\t\t\t/// verificar qual eh o programa da vez\n\t\t\t\n\n\t\t\tvar result = jlinq.from(objeto.programacao)\n  \t\t\t.starts('ano', ano)\n  \t\t\t.select();\n\n  \t\t\tresult = jlinq.from(result)\n  \t\t\t.starts('mes', mes)\n  \t\t\t.select();\n\n  \t\t\tresult = jlinq.from(result)\n  \t\t\t.starts('dia', dia)\n  \t\t\t.select();\n  \t\t\t\n  \t\t\tresult = jlinq.from(result)\n\t\t\t.sort(\"hora\")\n\t\t\t.select();\n\n\n\n  \t\t\tvar programacaoEmMinutos = new Array();\n\n  \t\t\tfor(i=0;i<result.length;i++)\n  \t\t\t{\n\n  \t\t\t\tvar m = result[i].hora * 60;\n  \t\t\t\tm += Number(result[i].minuto);\n\n  \t\t\t\tprogramacaoEmMinutos.push(m);\n\n  \t\t\t\t\n  \t\t\t}\n\n\n  \t\t\tvar mAtual = d.getHours()*60 + d.getMinutes();\n\n  \t\t\tvar dif = mAtual - getClosestValues(programacaoEmMinutos,mAtual)[0];\n  \t\t\tvar index = programacaoEmMinutos.indexOf(getClosestValues(programacaoEmMinutos,mAtual)[0]);\n\n\t\t\tconsole.log(result[index].url + \"&t=\" + dif + \"m\");\n\n  \t\t\t/*\n  \t\t\tvar result = jlinq.from(result)\n  \t\t\t.starts('minuto', minutos)\n  \t\t\t.select();\n\t\t\t*/\t\t\n\n\t\t\t\n\t\t\t/// tocar\n\t\t\t$(function(){\n\t\t\t\t$.okvideo({\n\t\t\t\t\tvideo: result[index].url,\n\t\t\t\t\tstartSec: (dif * 60 + segundos),\n                    volume: 0,\n\t\t\t\t\tadproof: true,\n\t\t\t\t\tonFinished: function() { \n\t\t\t\t\t\t// proximo programa\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t});\n\t\t\t\n\n\n\t\t\t/// infos\n            //document.getElementById(\"hora\").innerHTML = horaAtual;\n\t\t\t//document.getElementById(\"now\").innerHTML = \"<p class='titulo_box'>AGORA</p><p class='titulo_programa'>\" + \"Titulo\" + \"</p><a href=\" + result[0].url + \" target='_blank'>\" + result[0].nome + \"</a>\";\n\t\t\t//document.getElementById(\"next\").innerHTML = \"<p class='titulo_box'>A SEGUIR</p>\" + \"Horario Proximo\" + \" &nbsp;\" + \"Titulo Proximo;\n            \n\t\t\tdocument.write(\"<div id=hora>\" + horaAtual + \"</div>\");\n\t\t\tdocument.write(\"<div id=now>NOW PLAYING<br>\" + result[0].nome + \"</div>\");\n\t\t\t//document.write(\"<div id=next>NEXT SHOW<br>\" + result[0].hora + \" &nbsp; \" + result[0].nome + \"</div>\");\n\t\t\t\n\t\t\t\n\t\t\n\t\t</script>\n\t\t\n\t</head>\n    <!--\n    <body>\n    \t<div id=\"hora\" class=\"gradientCinzaEsc\"></div>\n\t\t<div id=\"now\" class=\"gradientCinzaEsc\"></div>\n\t\t<div id=\"next\" class=\"gradientCinzaEsc\"></div>\n\t</body>\n    -->\n</html>"]],"start1":0,"start2":0,"length1":0,"length2":3960}]],"length":3960,"saved":false}
